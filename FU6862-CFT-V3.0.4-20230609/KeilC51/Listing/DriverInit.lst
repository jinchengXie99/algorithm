C51 COMPILER V9.60.7.0   DRIVERINIT                                                        08/30/2023 13:47:06 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE DRIVERINIT
OBJECT MODULE PLACED IN .\Output\DriverInit.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\User\Source\Hardware\DriverInit.c LARGE OMF2 WARNINGLEVEL(0) OPTIMIZE
                    -(9,SPEED) BROWSE INCDIR(..\User\Include;..\FU68xx_Hardware_Driver\Include) DEBUG PRINT(.\Listing\DriverInit.lst) TABS(2)
                    - OBJECT(.\Output\DriverInit.obj)

line level    source

   1          /*  -------------------------- (C) COPYRIGHT 2022 Fortiortech ShenZhen ---------------------------*/
   2          /**
   3           * @copyright (C) COPYRIGHT 2022 Fortiortech Shenzhen
   4           * @file      xxx.c
   5           * @author    Fortiortech  Appliction Team
   6           * @since     Create:2022-07-14
   7           * @date      Last modify:2022-07-14
   8           * @note      Last modify author is Leo.li
   9           * @brief      
  10           */
  11          
  12          /* Includes -------------------------------------------------------------------------------------*/
  13          #include <FU68xx_2.h>
  14          #include <Myproject.h>
  15          
  16          
  17          /** 
  18           * @brief       DriverÂàùÂßãÂåñÈÖçÁΩÆ
  19           * @data        2022/08/12
  20           */   
  21          void Driver_Init(void)
  22          {
  23   1          /*ÈÖçÁΩÆPWMÂë®ÊúüÂÄºÂíåÊ≠ªÂå∫Êó∂Èó¥*/
  24   1          DRV_ARR             = PWM_VALUE_LOAD;                               // ËΩΩÊ≥¢È¢ëÁéáÁöÑÂë®ÊúüÂÄº
  25   1          DRV_DTR             = PWM_LOAD_DEADTIME;                            // Ê≠ªÂå∫Êó∂Èó¥
  26   1          /*  MESEL‰∏∫0ÔºåMEÊ®°ÂùóÂ∑•‰ΩúÂú®BLDCÊ®°Âºè
  27   1              MESEL‰∏∫1ÔºåMEÊ®°ÂùóÂ∑•‰ΩúÂú®FOC/SVPWM/SPWMÊ®°Âºè*/
  28   1          SetBit(DRV_CR, MESEL);
  29   1        
  30   1          /*È©±Âä®ÊúâÊïàÁîµÂπ≥ÂíåÁ©∫Èó≤ÁîµÂπ≥*/
  31   1          #if (PWM_Level_Mode == High_Level)
  32   1          {
  33   2              DRV_CMR &= 0x003f;
  34   2              DRV_OUT &= 0xC0;
  35   2          }
  36   1          #elif (PWM_Level_Mode == Low_Level)
                  {
                      DRV_CMR |= 0x0fc0;
                      DRV_OUT = 0x3F;
                  }
                  #elif (PWM_Level_Mode == UP_H_DOWN_L)
                  {
                      DRV_CMR = 0x0540;
                      DRV_OUT = 0x2A;
                  }
                  #elif (PWM_Level_Mode == UP_L_DOWN_H)
                  {
                      DRV_CMR &= 0x0a80;
                      DRV_OUT = 0x15;
                  }
                  #endif //end PWM_Level_Mode
  52   1          
  53   1          /*Ê∏Ö‰∏≠Êñ≠Ê†áÂøó‰ΩçÔºå‰ΩøËÉΩ‰∏≠Êñ≠ÔºåÈÖçÁΩÆÊØîËæÉÂÄºÔºåËÆæÁΩÆ‰∏≠Êñ≠‰ºòÂÖàÁ∫ß*/
C51 COMPILER V9.60.7.0   DRIVERINIT                                                        08/30/2023 13:47:06 PAGE 2   

  54   1          ClrBit(DRV_SR, DCIF);                                       // Ê∏ÖÈô§DRV‰∏≠Êñ≠Ê†áÂøó‰Ωç
  55   1          /**************************************************
  56   1              DRVÊØîËæÉÂåπÈÖç‰∏≠Êñ≠Ê®°Âºè
  57   1              ÂΩìËÆ°Êï∞ÂÄºÁ≠â‰∫éDRV_COMRÊó∂ÔºåÊ†πÊçÆDCIMÁöÑËÆæÁΩÆÂà§Êñ≠ÊòØÂê¶‰∫ßÁîü‰∏≠Êñ≠Ê†áËÆ∞
  58   1              00Ôºö‰∏ç‰∫ßÁîü‰∏≠Êñ≠
  59   1              01Ôºö‰∏äÂçáÊñπÂêë
  60   1              10Ôºö‰∏ãÈôçÊñπÂêë
  61   1              11Ôºö‰∏äÂçá/‰∏ãÈôçÊñπÂêë
  62   1          *************************************************/
  63   1          SetReg(DRV_SR, DCIM0 | DCIM1, 0);
  64   1          
  65   1          /*ËÆæÁΩÆDRVËÆ°Êï∞Âô®ÁöÑÊØîËæÉÂåπÈÖçÂÄºÔºåÂΩìDRVËÆ°Êï∞ÂÄº‰∏éCOMRÁõ∏Á≠âÊó∂ÔºåÊ†πÊçÆDRV_SRÂØÑÂ≠òÂô®ÁöÑDCI
             -MÊòØÂê¶‰∫ßÁîüÊØîËæÉÂåπÈÖç‰∫ã‰ª∂*/
  66   1          DRV_COMR = (PWM_VALUE_LOAD >> 1);
  67   1          PDRV1 = 1;                                              // ‰∏≠Êñ≠‰ºòÂÖàÁ∫ßËÆæÁΩÆ‰∏∫2Ôºå‰ºòÂÖàÁ∫ß‰Ωé‰∫é
             -FOÁ°¨‰ª∂ËøáÊµÅ
  68   1          PDRV0 = 0;
  69   1          SetBit(DRV_SR, DCIP);                                     // 0--1‰∏™ËΩΩÊ≥¢Âë®ÊúüÊâßË°å‰∏ÄÊ¨°foc‰∏≠Êñ≠Ô
             -ºå1--2‰∏™ËΩΩÊ≥¢Âë®ÊúüÊâßË°å‰∏ÄÊ¨°foc‰∏≠Êñ≠
  70   1          /*DRVËÆ°Êï∞Âô®‰ΩøËÉΩÔºå0-Á¶ÅÊ≠¢Ôºå1-‰ΩøËÉΩ*/
  71   1          SetBit(DRV_CR, DRVEN);
  72   1          /*DRVËÆ°Êï∞Âô®ÊØîËæÉÂÄºÈ¢ÑË£ÖËΩΩ‰ΩøËÉΩÔºå0-Á¶ÅÊ≠¢Ôºå1-‰ΩøËÉΩ*/
  73   1          ClrBit(DRV_CR, DRPE);
  74   1          /*Driver ËæìÂá∫‰ΩøËÉΩÔºå0-Á¶ÅÊ≠¢Ôºå1-‰ΩøËÉΩ*/
  75   1          SetBit(DRV_CR, DRVOE);
  76   1      }
  77          
  78          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     90    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
